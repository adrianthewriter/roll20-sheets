<div class="sheet-root sheet-gildeduniverse"><input type="hidden" name="attr_dialog_session-log" value="hidden" class="sheet-field"><input type="hidden" name="attr_sheet_mode" value="character" class="sheet-field"><div class="sheet-dialog sheet-dialog--session-log"><div class="sheet-container"><label class="sheet-toggle"><input type="checkbox" name="attr_dialog_session-log" value="hidden" class="sheet-togglebox"><span></span></label><h2>Session Log</h2><div class="sheet-content"><div class="sheet-table--sessionlog"><div class="sheet-tableheader"><span class="sheet-view"></span><span>Session Date</span><span>XP Gained</span></div><fieldset class="repeating_sessionlog"><div class="sheet-tablerow"><input type="hidden" name="attr_session-header" class="sheet-toggle sheet-togglebox"><label class="sheet-toggle"><input type="checkbox" name="attr_session-toggle" value="hidden" class="sheet-togglebox"><span></span></label><input type="text" name="attr_session-date" value="" class="sheet-field"><input type="text" name="attr_session-xp" value="" class="sheet-field"><input type="hidden" name="attr_session-toggle" class="sheet-toggle sheet-togglebox"><div class="sheet-drawer sheet-drawer--session-details"><textarea name="attr_session-desc" class="sheet-field"></textarea><label class="sheet-toggle"><input type="checkbox" name="attr_session-header" value="checked" class="sheet-togglebox"><span>Mark as 'Header'</span></label></div></div></fieldset></div></div></div></div><div class="sheet-mode sheet-mode--character"><div class="sheet-header"><div><label class="sheet-field"><span>Name</span><input type="text" name="attr_character-name" value="" class="sheet-field"></label><label class="sheet-field"><span>Player</span><input type="text" name="attr_player-name" value="" class="sheet-field"></label><div class="sheet-container"><label class="sheet-toggle"><input type="checkbox" name="attr_dialog_session-log" value="checked" class="sheet-togglebox"><span></span></label><label class="sheet-field"><span>XP</span><input type="text" name="attr_character-xp" value="" class="sheet-field"><span class="sheet-sep">/</span><input type="text" name="attr_character-xp_max" value="" class="sheet-field"></label></div></div><div><h1 class="sheet-logo"><span class="sheet-logobox"><span class="sheet-logotype">Gilded Universe</span></span></h1><span class="sheet-subtitle" name="attr_sheet-mode_max">Character Sheet</span></div><div><label class="sheet-field"><span>Age</span><input type="text" name="attr_character-age" value="" class="sheet-field"></label><label class="sheet-field"><span>Sex</span><input type="text" name="attr_character-sex" value="" class="sheet-field"></label><label class="sheet-field"><span>Height</span><input type="text" name="attr_character-ht" value="" class="sheet-field"></label><label class="sheet-field"><span>Weight</span><input type="text" name="attr_character-wt" value="" class="sheet-field"></label></div></div><div class="sheet-sec sheet-sec--main"><div><div class="sheet-group sheet-group--attrs"><div class="sheet-label"><span>Attributes</span></div><div class="sheet-content"><div class="sheet-attr"><span class="sheet-label">STR</span><input type="text" name="attr_str" value="" class="sheet-field"><label class="sheet-toggle" title="Mark as 'Key Attribute'"><input type="checkbox" name="attr_str-marked" value="1" class="sheet-togglebox"><span></span></label></div><div class="sheet-attr"><span class="sheet-label">DEX</span><input type="text" name="attr_dex" value="" class="sheet-field"><label class="sheet-toggle" title="Mark as 'Key Attribute'"><input type="checkbox" name="attr_dex-marked" value="1" class="sheet-togglebox"><span></span></label></div><div class="sheet-attr"><span class="sheet-label">INT</span><input type="text" name="attr_int" value="" class="sheet-field"><label class="sheet-toggle" title="Mark as 'Key Attribute'"><input type="checkbox" name="attr_int-marked" value="1" class="sheet-togglebox"><span></span></label></div><div class="sheet-attr"><span class="sheet-label">WIT</span><input type="text" name="attr_wit" value="" class="sheet-field"><label class="sheet-toggle" title="Mark as 'Key Attribute'"><input type="checkbox" name="attr_wit-marked" value="1" class="sheet-togglebox"><span></span></label></div></div></div><div class="sheet-group sheet-flip sheet-group--stats"><div class="sheet-label"><span>Other Stats</span></div><div class="sheet-content"><label class="sheet-field"><span>Health</span><input type="text" name="attr_health" value="" class="sheet-field"><span class="sheet-sep">/</span><input type="text" name="attr_health_max" value="" class="sheet-field"></label><div><label class="sheet-field"><span>Armor</span><input type="text" name="attr_armor" value="" class="sheet-field"></label><label class="sheet-field"><span>Def.</span><input type="text" name="attr_defense" value="" class="sheet-field"></label></div><label class="sheet-field"><span>Vigor</span><input type="text" name="attr_vigor" value="" class="sheet-field"><span class="sheet-sep">/</span><input type="text" name="attr_vigor_max" value="" class="sheet-field"></label><label class="sheet-field"><span>Resolve</span><input type="text" name="attr_resolve" value="" class="sheet-field"><span class="sheet-sep">/</span><input type="text" name="attr_resolve_max" value="" class="sheet-field"></label><label class="sheet-field"><button type="roll" name="roll_reaction" value="&amp;{template:reactionRoll} {{name=@{character-name}}} {{title=Reaction}} {{dice=[[@{reaction}-@{reaction}d6>2f<@{dex}scs=1cf=0]]}} "><span>Reaction</span></button><input type="text" name="attr_reaction" value="" class="sheet-field"></label><label class="sheet-field"><span>Speed</span><input type="text" name="attr_speed" value="" class="sheet-field"></label></div></div></div><div class="sheet-box sheet-box--lifepaths"><h2><span class="sheet-label">Lifepaths</span></h2><div class="sheet-content"><div class="sheet-table--lifepaths"><fieldset class="repeating_lifepaths"><div class="sheet-tablerow"><label class="sheet-field"><span></span><input type="text" name="attr_lifepath" value="" class="sheet-field"></label><div class="sheet-meter" title="Take +2d6 (max 10d6) on two Skill checks related to this Lifepath."><input type="checkbox" name="attr_lifepath-bonus" value="0" checked="" class="sheet-hidden sheet-meterbox"><input type="checkbox" name="attr_lifepath-bonus" value="1" class="sheet-meterbox"><span></span><input type="checkbox" name="attr_lifepath-bonus" value="2" class="sheet-meterbox"><span></span></div></div></fieldset></div></div></div><div class="sheet-group sheet-group--skills"><div class="sheet-label"><span>Skills</span></div><div class="sheet-content"><div><input type="hidden" name="attr_brute-force_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{str}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_brute-force" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Brute Force (STR)}} {{marked=[[@{str-marked}]]}} @{brute-force_formula} "><span>Brute Force (STR)</span></button><input type="text" name="attr_brute-force" value="" class="sheet-field"></label><input type="hidden" name="attr_close-combat_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{str}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_close-combat" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Close Combat (STR)}} {{marked=[[@{str-marked}]]}} @{close-combat_formula} "><span>Close Combat (STR)</span></button><input type="text" name="attr_close-combat" value="" class="sheet-field"></label><input type="hidden" name="attr_machinery_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{str}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_machinery" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Machinery (STR)}} {{marked=[[@{str-marked}]]}} @{machinery_formula} "><span>Machinery (STR)</span></button><input type="text" name="attr_machinery" value="" class="sheet-field"></label><input type="hidden" name="attr_stamina_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{str}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_stamina" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Stamina (STR)}} {{marked=[[@{str-marked}]]}} @{stamina_formula} "><span>Stamina (STR)</span></button><input type="text" name="attr_stamina" value="" class="sheet-field"></label></div><div><input type="hidden" name="attr_mobility_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{dex}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_mobility" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Mobility (DEX)}} {{marked=[[@{dex-marked}]]}} @{mobility_formula} "><span>Mobility (DEX)</span></button><input type="text" name="attr_mobility" value="" class="sheet-field"></label><input type="hidden" name="attr_piloting_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{dex}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_piloting" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Piloting (DEX)}} {{marked=[[@{dex-marked}]]}} @{piloting_formula} "><span>Piloting (DEX)</span></button><input type="text" name="attr_piloting" value="" class="sheet-field"></label><input type="hidden" name="attr_ranged-combat_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{dex}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_ranged-combat" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Ranged Combat (DEX)}} {{marked=[[@{dex-marked}]]}} @{ranged-combat_formula} "><span>Ranged Combat (DEX)</span></button><input type="text" name="attr_ranged-combat" value="" class="sheet-field"></label><input type="hidden" name="attr_tinkering_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{dex}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_tinkering" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Tinkering (DEX)}} {{marked=[[@{dex-marked}]]}} @{tinkering_formula} "><span>Tinkering (DEX)</span></button><input type="text" name="attr_tinkering" value="" class="sheet-field"></label></div><div><input type="hidden" name="attr_history_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{int}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_history" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=History (INT)}} {{marked=[[@{int-marked}]]}} @{history_formula} "><span>History (INT)</span></button><input type="text" name="attr_history" value="" class="sheet-field"></label><input type="hidden" name="attr_medicine_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{int}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_medicine" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Medicine (INT)}} {{marked=[[@{int-marked}]]}} @{medicine_formula} "><span>Medicine (INT)</span></button><input type="text" name="attr_medicine" value="" class="sheet-field"></label><input type="hidden" name="attr_science_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{int}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_science" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Science (INT)}} {{marked=[[@{int-marked}]]}} @{science_formula} "><span>Science (INT)</span></button><input type="text" name="attr_science" value="" class="sheet-field"></label><input type="hidden" name="attr_technology_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{int}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_technology" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Technology (INT)}} {{marked=[[@{int-marked}]]}} @{technology_formula} "><span>Technology (INT)</span></button><input type="text" name="attr_technology" value="" class="sheet-field"></label></div><div><input type="hidden" name="attr_command_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{wit}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_command" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Command (WIT)}} {{marked=[[@{wit-marked}]]}} @{command_formula} "><span>Command (WIT)</span></button><input type="text" name="attr_command" value="" class="sheet-field"></label><input type="hidden" name="attr_manipulation_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{wit}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_manipulation" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Manipulation (WIT)}} {{marked=[[@{wit-marked}]]}} @{manipulation_formula} "><span>Manipulation (WIT)</span></button><input type="text" name="attr_manipulation" value="" class="sheet-field"></label><input type="hidden" name="attr_observation_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{wit}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_observation" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Observation (WIT)}} {{marked=[[@{wit-marked}]]}} @{observation_formula} "><span>Observation (WIT)</span></button><input type="text" name="attr_observation" value="" class="sheet-field"></label><input type="hidden" name="attr_survival_formula" value="{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{wit}scs=1cf=0]]}} {{zerodice=1}}" class="sheet-field"><label class="sheet-field"><button type="roll" name="roll_survival" value="&amp;{template:skillRoll} {{name=@{character-name}}} {{title=Survival (WIT)}} {{marked=[[@{wit-marked}]]}} @{survival_formula} "><span>Survival (WIT)</span></button><input type="text" name="attr_survival" value="" class="sheet-field"></label></div></div></div><div class="sheet-box sheet-box--injuries"><h2><span class="sheet-label">Critical Injuries</span></h2><div class="sheet-content"><div class="sheet-table--injuries"><fieldset class="repeating_injuries"><div class="sheet-tablerow"><label class="sheet-field"><span></span><input type="text" name="attr_injury" value="" class="sheet-field"></label><label class="sheet-field"><span></span><input type="text" name="attr_injury_max" value="" class="sheet-field"></label></div></fieldset></div></div></div><div class="sheet-box sheet-box--augments"><h2><span class="sheet-label">Augments</span></h2><div class="sheet-content"><div class="sheet-table--augments"><fieldset class="repeating_augments"><div class="sheet-tablerow"><input type="hidden" name="attr_augment_max" class="sheet-toggle sheet-togglebox"><label class="sheet-toggle"><input type="checkbox" name="attr_augment_max" value="expand" class="sheet-togglebox"><span></span></label><label class="sheet-field"><span></span><input type="text" name="attr_augment" value="" class="sheet-field"></label><label class="sheet-field"><span></span><textarea name="attr_augment" class="sheet-field"></textarea></label></div></fieldset></div></div></div><div class="sheet-box sheet-box--equipment"><h2><span class="sheet-label">Equipment</span></h2><div class="sheet-content"><label class="sheet-field"><span>$</span><input type="text" name="attr_money" value="" class="sheet-field"></label><span>Roll [number] or higher on 1d6 to ready an item as a Fast Action.</span><div class="sheet-table--equipment"><fieldset class="repeating_equipment"><div class="sheet-tablerow"><input type="hidden" name="attr_item_max" class="sheet-toggle sheet-togglebox"><label class="sheet-toggle"><input type="checkbox" name="attr_item_max" value="expand" class="sheet-togglebox"><span></span></label><label class="sheet-field"><span></span><input type="text" name="attr_item" value="" class="sheet-field"></label><label class="sheet-field"><span></span><textarea name="attr_item" class="sheet-field"></textarea></label></div></fieldset></div><h4>Other Items</h4><div class="sheet-table--other-items"><fieldset class="repeating_other-items"><div class="sheet-tablerow"><input type="text" name="attr_item" value="" class="sheet-field"></div></fieldset></div></div></div><div class="sheet-box sheet-box--notes"><h2><span class="sheet-label">Notes</span></h2><div class="sheet-content"><div class="sheet-table--notes"><fieldset class="repeating_notes"><div class="sheet-tablerow"><input type="hidden" name="attr_note_max" class="sheet-toggle sheet-togglebox"><label class="sheet-toggle"><input type="checkbox" name="attr_note_max" value="expand" class="sheet-togglebox"><span></span></label><label class="sheet-field"><span></span><input type="text" name="attr_note" value="" class="sheet-field"></label><label class="sheet-field"><span></span><textarea name="attr_note" class="sheet-field"></textarea></label></div></fieldset></div></div></div></div><div class="sheet-sec sheet-sec--side"><div class="sheet-box sheet-box--talents"><h2><span class="sheet-label">Talents</span></h2><div class="sheet-content"><div class="sheet-table--talents"><fieldset class="repeating_talents"><div class="sheet-tablerow"><input type="hidden" name="attr_talent_max" value="checked" class="sheet-toggle sheet-togglebox"><label class="sheet-toggle"><input type="checkbox" name="attr_talent_max" value="expand" class="sheet-togglebox"><span></span></label><label class="sheet-field"><span></span><input type="text" name="attr_talent" value="" class="sheet-field"></label><label class="sheet-field"><span></span><textarea name="attr_talent-desc" class="sheet-field"></textarea></label></div></fieldset></div></div></div></div></div></div><div class="message general"><rolltemplate class="sheet-rolltemplate-reactionRoll"><div class="sheet-rollbox"><div class="sheet-rollheader"><p class="sheet-rollprelude"><em>{{name}}</em>{{#title}}<span>{{#action}}{{action}}{{/action}}{{^action}}checks{{/action}}</span><span class="sheet-rolltitle">{{title}}</span>{{/title}}</p></div><div class="sheet-rollcontent"><span class="sheet-rolloutput">{{dice}} HITs</span>{{#rollWasCrit() dice}}<hr><span class="sheet-rollnote">Gain +1 Combat Action per TRIGGER rolled!</span>{{/rollWasCrit() dice}}</div></div></rolltemplate></div><div class="message general"><rolltemplate class="sheet-rolltemplate-skillRoll"><div class="sheet-rollbox"><div class="sheet-rollheader"><p class="sheet-rollprelude"><em>{{name}}</em>{{#title}}<span>{{#action}}{{action}}{{/action}}{{^action}}checks{{/action}}</span><span class="sheet-rolltitle">{{title}}</span>{{/title}}</p></div><div class="sheet-rollcontent"><span class="sheet-rolloutput">{{#zerodice}}<span class="sheet-rollresult">Untrained Skill</span>{{/zerodice}}{{dice}}{{#rollTotal() dice 0}} HITs<span class="sheet-rollfumble">Failure</span>{{/rollTotal() dice 0}}{{#rollTotal() dice 1}} HIT<span class="sheet-rollsuccess">Weak Success</span>{{/rollTotal() dice 1}}{{#rollGreater() dice 1}} HITs<span class="sheet-rollcrit">Strong Success</span>{{#rollWasCrit() dice}}<span class="sheet-rollresult">with TRIGGERS!</span>{{/rollWasCrit() dice}}{{/rollGreater() dice 1}}</span>{{#rollTotal() marked 1}}{{#rollGreater() dice 0}}<hr><span class="sheet-rollnote">You're using your Key Attribute. Gain +1 XP! (Except during combat)</span>{{/rollGreater() dice 0}}{{/rollTotal() marked 1}}{{#rollTotal() dice 0}}<hr><span class="sheet-rollnote">You learn from your mistakes. Gain +1 XP! (Except during combat)</span>{{/rollTotal() dice 0}}</div></div></rolltemplate></div>
<script type="text/worker">(()=>{"use strict";const t=JSON.parse('{"u2":"gilded-universe","i8":"0.1.0"}');class e{constructor(){return this.__triggers=[],this.__attrs=[],this.__fields=[],this}getTriggers(){return this.triggers.map((t=>{let{event:e,attr:r,section:i}=t;return i&&r?`${e}:repeating_${i}:${r}`:i&&!r?`${e}:repeating_${i}`:`${e}:${r}`}))}get triggers(){return this.__triggers}get attrs(){return this.__attrs}get fields(){return this.__fields}addTrigger(t){this.__triggers.push(t)}addAttr(t){this.__attrs.push(t)}addField(t){this.__fields.push(t)}}function r(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=new class{constructor(t,r){return this.__gameId=t,this.__version=r,this.__context=new e,this.toolbox=this.__toolbox(),this.util=this.__util(),this}get gameId(){return this.__gameId}get version(){return this.__version}get ctx(){return this.__context}resetCtx(){this.__context=new e}__util(){return{parseValues:(t,e=!1)=>{let r={},i={};return r=(t=Object.entries(t)).filter((([t,e])=>!t.includes("repeating_"))),r=Object.fromEntries(r),t.filter((([t,e])=>t.includes("repeating_"))).forEach((([t,e])=>{let r,s,n,a;if(r=t.match(/^repeating_([A-Za-z0-9-]+)_?(-[A-Za-z0-9-]+)?_([A-Za-z0-9-_]+)$/),s=!!r[1]&&r[1],n=!!r[2]&&r[2],a=!!r[3]&&r[3],i[s]||(i[s]=[]),i[s].length){let t=i[s].filter((t=>t.rowId===n))[0];t||i[s].push({rowId:n,[a]:e}),t&&!t[a]&&(t[a]=e)}else i[s].push({rowId:n,[a]:e})})),e&&(i=Object.entries(i),i=i.map((([t,e])=>(1===e.length&&(e=e[0]),[t,e]))),i=Object.fromEntries(i)),{attrSet:r,fieldSet:i}}}}__toolbox(){return{setAttrs:(t,...e)=>{let r,i;1===e.length&&_.isFunction(e[0])?i=e[0]:1===e.length&&_.isString(e[0])?r=e[0]:2===e.length&&_.isString(e[0])&&_.isFunction(e[1])&&(r=e[0],i=e[1]),r&&(t=(t=Object.entries(t)).map((([t,e])=>[`repeating_${r}_${t}`,e])),t=Object.fromEntries(t)),i?setAttrs(t,i):setAttrs(t)},getAllFields:(t,e,r)=>{getAttrs([`_reporder_repeating_${e}`],(i=>{getSectionIDs(e,(s=>{let n=i[`_reporder_repeating_${e}`]?i[`_reporder_repeating_${e}`].toLowerCase().split(","):[],a=[...new Set(n.filter((t=>s.includes(t))).concat(s))],o=Object.getOwnPropertyNames(t[e][0]),l=new Set;a.forEach((t=>{o.forEach((r=>{"rowId"!==r&&l.add(`repeating_${e}_${t}_${r}`)}))})),getAttrs(Array.from(l),(t=>{const{fieldSet:i}=this.util.parseValues(t);_.partial(r,i[e])()}))}))}))}}}listen(t,e=!1){if(!t)throw new Error("'listen()' must be called with an 'triggers' argument in the form of a String or an Array<String>.");return this.ctx&&this.ctx.triggers.length||this.resetCtx(),t&&_.isString(t)&&(t=t.split(" ")),(t=t.map((t=>({event:(t=t.split(":"))[0]?t[0]:_.noop(),attr:t[1]?t[1]:_.noop(),section:e||_.noop()})))).forEach((t=>{this.ctx.addTrigger(t)})),this}getAttrs(t){if(!t)throw new Error("'getAttrs()' must be called with an 'attrs' argument in the form of a String or an Array<String>.");return t&&_.isString(t)&&(t=t.split(" ")),t.forEach((t=>{this.ctx.addAttr(t)})),this}getFields(t,e,r=!1){if(!t)throw new Error("'getFields()' must be called with an 'fields' argument in the form of a String or an Array<String>.");if(!e)throw new Error("'getFields()' must be called with an 'section' argument in the form of a String.");return t&&_.isString(t)&&(t=t.split(" ")),t=t.map((t=>({field:t,section:e}))),r?t:(t.forEach((t=>{this.ctx.addField(t)})),this)}then(t){if(!_.isFunction(t))throw new Error("'.then()' must receive a function.");let e,r,i;return e=this.ctx.getTriggers(),r=this.ctx.attrs,i=this.ctx.fields.map((({section:t,field:e})=>`repeating_${t}_${e}`)),on(e.join(" "),(s=>{getAttrs(_.union(r,i),(r=>{const{attrSet:i,fieldSet:n}=this.util.parseValues(r);try{_.partial(t,{e:s,gameId:this.gameId,version:this.version,attrSet:i,fieldSet:n,getAllFields:_.partial(this.toolbox.getAllFields,n),setAttrs:_.partial(this.toolbox.setAttrs)})()}catch(t){throw new Error(`SheetWorker failed in 'on(${e.join(" ")})'`,t)}}))})),this.resetCtx(),!1}}(t.u2,t.i8);n.listen("sheet:opened").getAttrs(["sheet_ver","character_name","character-name"]).then((function(t){var e,i=t.version,n=t.attrSet,a=t.setAttrs,o=n.character_name,l=n["character-name"]||o,c=n.sheet_ver,u=i;if(c&&""!=c)return a(s({},"sheet_ver",u)),!1;var h=function(t,e){var i;if(t>0)return(i=t,r(Array(i+1).keys()).slice(1)).map((function(){var t=generateRowID();return Object.fromEntries(e.map((function(e){var r=e.field,i=e.value;return["".concat(t,"_").concat(r),i]})))}))};a((s(e={},"sheet_ver",u),s(e,"sheet_mode","character"),s(e,"character-name",""!=l?l:o),s(e,"character-xp_max","450"),s(e,"money","0.00"),e),(function(){console.log("Your new character was created! Have fun!")})),a(Object.assign.apply(Object,r(h(1,[{field:"session-toggle",value:"hidden"},{field:"session-date",value:"Character Creation"},{field:"session-xp",value:"450"}])).concat(r(h(1,[{field:"session-toggle",value:"hidden"},{field:"session-date",value:"Campaign Arc 1"},{field:"session-header",value:"checked"}])),r(h(1,[{field:"session-date",value:"First Session!"},{field:"session-xp",value:""}])))),"sessionlog"),a(Object.assign.apply(Object,r(h(3,[{field:"lifepath",value:""}]))),"lifepaths"),a(Object.assign.apply(Object,r(h(6,[{field:"item",value:""}]))),"equipment"),a(Object.assign.apply(Object,r(h(4,[{field:"item",value:""}]))),"other-items")}));Array.from([{skill:"brute-force",attr:"str"},{skill:"close-combat",attr:"str"},{skill:"machinery",attr:"str"},{skill:"stamina",attr:"str"},{skill:"mobility",attr:"dex"},{skill:"piloting",attr:"dex"},{skill:"ranged-combat",attr:"dex"},{skill:"tinkering",attr:"dex"},{skill:"history",attr:"int"},{skill:"medicine",attr:"int"},{skill:"science",attr:"int"},{skill:"technology",attr:"int"},{skill:"command",attr:"wit"},{skill:"manipulation",attr:"wit"},{skill:"observation",attr:"wit"},{skill:"survival",attr:"wit"}]).forEach((function(t){var e=t.skill,r=t.attr;n.listen("change:".concat(e)).then((function(t){var i=t.e,n=t.setAttrs;"0"===String(i.newValue)&&"player"===i.sourceType&&n({skill:(parseInt(i.previousValue)||1)-1}),n(s({},"".concat(e,"_formula"),function(t,e){return e>0?"{{dice=[[[[".concat(e,"+(?{Bonus Dice|0})-?{Burn|0}]]-[[").concat(e,"+(?{Bonus Dice|0})]]d6dl?{Burn|0}>2f<@{").concat(t,"}scs=1cf=0]]}}"):"{{dice=[[[[1+(?{Bonus Dice|0})-?{Burn|0}]]-[[2+(?{Bonus Dice|0})]]d6dl[[1+?{Burn|0}]]>2f<@{".concat(t,"}scs=1cf=0]]}} {{zerodice=1}}")}(r,i.newValue||"0")))}))})),n.listen(["change:session-xp","change:session-header","remove"],"sessionlog").getFields(["session-xp","session-header"],"sessionlog").then((function(t){t.e;var e=t.getAllFields,r=t.setAttrs;e("sessionlog",(function(t){var e=0;t.forEach((function(t){"checked"!==t["session-header"]&&(e+=parseInt(t["session-xp"],10)||0)})),r(s({},"character-xp_max",e))}))}))})();</script>